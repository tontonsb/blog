<!DOCTYPE html>
<html lang="lv">
	<head>
		<meta charset="utf-8">

		<link
			href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22256%22 height=%22256%22 fill=%22%23ff3e00%22 viewBox=%220 0 100 100%22><text x=%2250%%22 y=%2250%%22 dominant-baseline=%22central%22 text-anchor=%22middle%22 font-size=%2280%22>‚àÇ¬≤ùëß</text></svg>"
			type="image/svg+xml"
			rel="shortcut icon" >

		<script>
			// TODO: Put this in a matomo component
			var _paq = window._paq = window._paq || []

			_paq.push(['setTrackerUrl', 'https://matomo.glaive.pro/matomo.php'])
			_paq.push(['setSiteId', '1'])

			_paq.push(['disableCookies'])
			_paq.push(['trackPageView'])
			_paq.push(['enableLinkTracking'])

			{
				// https://developer.matomo.org/guides/spa-tracking
				let currentUrl = location.pathname

				// Need to wait for the next tick so that the title is updated
				const trackMatomoView = () => setTimeout(() => {
					_paq.push(['setReferrerUrl', currentUrl])
					currentUrl = location.pathname
					_paq.push(['setCustomUrl', currentUrl])
					_paq.push(['setDocumentTitle', document.title])

					// remove all previously assigned custom variables
					// _paq.push(['deleteCustomVariables', 'page'])

					_paq.push(['trackPageView'])

					// make Matomo aware of newly added content
					// var content = document.getElementById('content')
					// _paq.push(['MediaAnalytics::scanForMedia', content])
					// _paq.push(['FormAnalytics::scanForForms', content])
					// _paq.push(['trackContentImpressionsWithinNode', content])
					_paq.push(['enableLinkTracking'])
				}, 0)

				// Add a proxy to pushstate
				if (history) {
					const pushState = history.pushState

					history.pushState = function() {
						const result = pushState.apply(history, arguments)

						dispatchEvent(new Event('locationchange'))

						return result
					}

					window.addEventListener('popstate', trackMatomoView)
					window.addEventListener('locationchange', trackMatomoView)
				}
			}
		</script>
		<script defer async src="https://matomo.glaive.pro/matomo.js"></script>

		%sveltekit.head%
	</head>
	<!-- TODO: change prefetch to preload-data when sveltekit is updated -->
	<!-- https://github.com/sveltejs/kit/blob/master/packages/create-svelte/templates/default/src/app.html#L9 -->
	<body data-sveltekit-prefetch>
		<div style="display: contents" class="app">%sveltekit.body%</div>
	</body>
</html>
